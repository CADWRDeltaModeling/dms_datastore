

dropbox_home: //cnrastore-bdo/Modeling_Data/
target_tz: "Etc/GMT+8"    # Odd, but the correct one in POSIX/pandas for PST.
target_tz_label: PST 


data:
  - name: ccfb
    skip: False
    collect:
      file_pattern: "CC_Gate_Positions*2024*.csv"
      wildcard: time_overlap    # time_sharded | time_overlap | data | none. 
            # If time_sharded, indicates non-overlapping timestamps that uses year chunking. 
            # If time_overlap, indicates wildcards are ordered by date 20250531(lexicographic must = chronological)
            # If data, represents different station/variable. Look for metadata in the file and station lists. 
            # If none, a wildcard is an error. # todo: test
      location:   "${dropbox_home}/hydraulic_structures/incoming"  # This could be understood as a default
      recursive_search: False
      reader: read_ts    # Names, pointers to code etc. To be fleshed out
      reader_args: 
         names: ["datetime", "gate_1","gate_2","gate_3","gate_4","gate_5"]
         na_values: ["(null)", "null", "NULL", ""]
         hint: "resort"
      merge_method: "ts_splice" # We will not call read_ts on wildcard, but rather glob and read and creat list of dfs
      merge_args: 
         transition: prefer_first
      selector: null  # Usually a column name. When read_last_resort_csv is used, use null.
    transforms:
      - name: dst_tz      # SCADA is delivered local time. Often this is not needed from better data sources
        args:
          src_tz: US/Pacific
          target_tz: ${target_tz}
      - name: coarsen
        args:
          grid: 2min
          preserve_vals: [0.0]
          qwidth: 0.01
          hyst: 0.5
          heartbeat_freq: 60min    
    metadata: 
      station_id: ccf
      agency_id: ccf
      source: dms
      agency: dwr
      freq: None   # None for irregular, "infer" for infer.
      param: height
      unit: ft
      sublocation: radial
      time_zone: ${target_tz}
      time_zone_label: ${target_tz_label}   
      latitude: 37.8299         # projected will be inferred. User changes should be made to projected, not latitude/longitude. 
      longitude: -121.55694

    output:
      staging_dir: ./drop_staging/formatted
      write_args:
        float_format: "%0.3f"   # optional, fallback = 0.6f
        chunk_years: False
      repo_dir: ./fake_repo/formatted
      merge_priority: staged
      allow_new_series: true
      inspection:
        recent_years: 3
        p3: 0.15
        p10: 0.05      